<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Enrichment Statistics | Functional Enrichment Workshop</title>
<meta name="author" content="Monash Genomics and Bioinformatics Platform (MGBP)">
<meta name="description" content="Enrichment statistics are based on a contingency table like so: Gene ..in term ..not in term Total ..in gene list 50 100 150 ..not in gene list (but in background) 200 15900 16100 Total 250 16000...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 3 Enrichment Statistics | Functional Enrichment Workshop">
<meta property="og:type" content="book">
<meta property="og:description" content="Enrichment statistics are based on a contingency table like so: Gene ..in term ..not in term Total ..in gene list 50 100 150 ..not in gene list (but in background) 200 15900 16100 Total 250 16000...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Enrichment Statistics | Functional Enrichment Workshop">
<meta name="twitter:description" content="Enrichment statistics are based on a contingency table like so: Gene ..in term ..not in term Total ..in gene list 50 100 150 ..not in gene list (but in background) 200 15900 16100 Total 250 16000...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Functional Enrichment Workshop</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Getting started</a></li>
<li><a class="" href="overview.html"><span class="header-section-number">2</span> Overview</a></li>
<li><a class="active" href="enrichment-statistics.html"><span class="header-section-number">3</span> Enrichment Statistics</a></li>
<li><a class="" href="example-analysis.html"><span class="header-section-number">4</span> Example Analysis</a></li>
<li><a class="" href="defining-the-genelist.html"><span class="header-section-number">5</span> Defining the genelist</a></li>
<li><a class="" href="reporting-results.html"><span class="header-section-number">6</span> Reporting results</a></li>
<li><a class="" href="resources.html"><span class="header-section-number">7</span> Resources</a></li>
<li><a class="" href="end-of-session-challenge.html"><span class="header-section-number">8</span> End of Session Challenge</a></li>
<li><a class="" href="feedback.html"><span class="header-section-number">9</span> Feedback</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/MonashBioinformaticsPlatform/Functional_Enrichment_BioCommons_2024">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="enrichment-statistics" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Enrichment Statistics<a class="anchor" aria-label="anchor" href="#enrichment-statistics"><i class="fas fa-link"></i></a>
</h1>
<p>Enrichment statistics are based on a contingency table like so:</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="37%">
<col width="20%">
<col width="28%">
<col width="13%">
</colgroup>
<thead><tr>
<th align="center">Gene</th>
<th align="right">..in term</th>
<th align="right">..not in term</th>
<th align="right">Total</th>
</tr></thead>
<tbody>
<tr>
<td align="center">..in gene list</td>
<td align="right">50</td>
<td align="right">100</td>
<td align="right">150</td>
</tr>
<tr>
<td align="center">..not in gene list (but in background)</td>
<td align="right">200</td>
<td align="right">15900</td>
<td align="right">16100</td>
</tr>
<tr>
<td align="center">Total</td>
<td align="right">250</td>
<td align="right">16000</td>
<td align="right">16250</td>
</tr>
</tbody>
</table></div>
<p>This is based on the 16250 genes that were measured in your experiment.</p>
<p>Note that there might be extra genes that weren’t measured these are excluded from the calculations entirely. E.g. There might have been an extra 5000 terms (some of which might have been annotated with the term of interest), making for 21250 <em>annotated</em> genes.</p>
<hr>
<div id="interactive-calculator" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Interactive Calculator<a class="anchor" aria-label="anchor" href="#interactive-calculator"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://bioinformatics3.erc.monash.edu/rsconnect/content/241/"><em>Link to open toy enrichment calculator</em></a>.</p>
<p>This calculates enrichment for a single hypothetical genelist (e.g. your RNAseq differentially expressed genelist) against a single hypothetical ‘term’ (some set of interesting genes, e.g. synaptic signaling genes). It makes a Venn diagram and a wordy description of what is being tested.</p>
<p>You can adjust various factors and see their effect on the enrichment p-values.</p>
<blockquote>
<p><em>Note:</em> This is just a toy calculator for this training, it quite limited. Bonus points if you break it. There are online hypergeometric test or fishers exact test calculators available if you ever need to calculate this directly e.g. : <a href="https://keisan.casio.com/exec/system/1180573201" class="uri">https://keisan.casio.com/exec/system/1180573201</a></p>
</blockquote>
<hr>
</div>
<div id="questions" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Questions<a class="anchor" aria-label="anchor" href="#questions"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Is it significant at p=0.05?
<details><summary>
Show
</summary>
No, corrected pval=0.087
</details>
</li>
<li>What about with a smaller background of 5000 genes (e.g. proteomic datasets)?
<details><summary>
Show
</summary>
Even less so - corrected pval=1
</details>
</li>
<li>Or, testing against a smaller database of terms; 2000 terms instead of 10000? With the original 16000 gene background.
<details><summary>
Show
</summary>
Yes, now corrected pval=0.017
</details>
</li>
<li>19 out of 200 differentially expressed genes (9.5%), need to hit for a 500-gene term (3.1% of all genes) to be significant at (p=0.048). How many hits would be needed for a more specific 30-gene term?
<details><summary>
Show
</summary>
5 hits - 2.5% of the differentially expressed genes vs 0.19% of all genes
</details>
</li>
</ol>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="overview.html"><span class="header-section-number">2</span> Overview</a></div>
<div class="next"><a href="example-analysis.html"><span class="header-section-number">4</span> Example Analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#enrichment-statistics"><span class="header-section-number">3</span> Enrichment Statistics</a></li>
<li><a class="nav-link" href="#interactive-calculator"><span class="header-section-number">3.1</span> Interactive Calculator</a></li>
<li><a class="nav-link" href="#questions"><span class="header-section-number">3.2</span> Questions</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/MonashBioinformaticsPlatform/Functional_Enrichment_BioCommons_2024/blob/master/03-stats.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/MonashBioinformaticsPlatform/Functional_Enrichment_BioCommons_2024/edit/master/03-stats.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Functional Enrichment Workshop</strong>" was written by Monash Genomics and Bioinformatics Platform (MGBP). It was last built on Compiled: August 30, 2024.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
