--- 
title: "Functional Enrichment Workshop"
author: 'Monash Genomics and Bioinformatics Platform (MGBP)'
date: 'Compiled: `r format(Sys.Date(), "%B %d, %Y")`'
site: bookdown::bookdown_site
documentclass: book
bibliography: [book.bib, packages.bib]
# url: your book url like https://bookdown.org/yihui/bookdown
# cover-image: path to the social sharing image like images/cover.jpg
description: |
  Functional enrichment analysis using online and commandline tools
link-citations: yes
github-repo: https://github.com/MonashBioinformaticsPlatform/Functional_Enrichment_Workshop_2024
---
```{r include=FALSE, cache=FALSE}
# example R options set globally
options(width = 60)

# example chunk options set globally
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE
)


# This reads the list of files/directories under
# copy_resources: in _bookdown.yml and copies them
# to the output document folder.
library(yaml)
library(fs)

yaml_path <- "_bookdown.yml"
config <- yaml::read_yaml(yaml_path)
additional_resources <- config$copy_resources
output_dir <- config$output_dir

copy_resources <- function(resources, output_dir) {
  for (resource in resources) {
    if (fs::file_exists(resource)) {
      if (fs::is_file(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(resource, target, overwrite = TRUE)
      }
      else if (fs::is_dir(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::dir_copy(resource, target, overwrite = TRUE)
      }
    } else if (grepl("[*?]", resource)) {
      files <- Sys.glob(resource)
      for (file in files) {
        target <- file.path(output_dir, file)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(file, target, overwrite = TRUE)
      }
    } else {
      warning(paste("Resource", resource, "not found or not recognized."))
    }
  }
}


copy_resources(additional_resources, output_dir)
```
***

# Getting started

Instructors: 
- Hossein V Kahrood
- Cali Willet

## Summary



Important links:






```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
    .packages(),
    "bookdown", "knitr", "rmarkdown"
), "packages.bib")

# So that renv includes these in the lock file
library("xml2")
library("downlit")
```

<!--chapter:end:index.Rmd-->

```{r include=FALSE, cache=FALSE}
# example R options set globally
options(width = 60)

# example chunk options set globally
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE
)


# This reads the list of files/directories under
# copy_resources: in _bookdown.yml and copies them
# to the output document folder.
library(yaml)
library(fs)

yaml_path <- "_bookdown.yml"
config <- yaml::read_yaml(yaml_path)
additional_resources <- config$copy_resources
output_dir <- config$output_dir

copy_resources <- function(resources, output_dir) {
  for (resource in resources) {
    if (fs::file_exists(resource)) {
      if (fs::is_file(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(resource, target, overwrite = TRUE)
      }
      else if (fs::is_dir(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::dir_copy(resource, target, overwrite = TRUE)
      }
    } else if (grepl("[*?]", resource)) {
      files <- Sys.glob(resource)
      for (file in files) {
        target <- file.path(output_dir, file)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(file, target, overwrite = TRUE)
      }
    } else {
      warning(paste("Resource", resource, "not found or not recognized."))
    }
  }
}


copy_resources(additional_resources, output_dir)
```
# Overview

## Functional analysis of -Omics data 
Workshop 2024

### General information

The workshop covers the bioinformatics concepts and tools available for interpreting a gene list using gene ontology and pathway information. The workshop focuses on the principles and concepts required for analyzing and conducting functional and pathway analysis on a gene list from any organism, although the focus will be on human and model eukaryotic organisms.

### Course Objectives

Participants will gain practical experience and skills to be able to:

- Understand basic concepts of functional enrichment analysis;
- Interpret enrichment analysis results;
- Get systems perspective of gene functions;
- Get more information about a gene list;
- Discover what pathways are enriched in a gene list (and use it for hypothesis generation);
- Predict gene function and extend a gene list;
- Follow workflow after the workshop to conduct their own analysis.

### Target Audience

This workshop is intended for biologists working with ‘-Omics data’ (e.g. RNA-Seq, protein expression and other omics data), who are interested in interpreting large gene/protein lists resulting from their experiments.

### Setup Requirements

This workshop will be delivered online over zoom; you may wish to install the dedicated zoom. Otherwise, no special software installation will required, as we will be using online analysis tools.  

 * Zoom Link: 


Links and material will be provided on the day. BYO coffee.


### Schedule

Time	|	Programme
-----------	| ------------------:
10:30	|	Welcome & Session 1
12:00	|	Break
12:20	|	Session 2
13:30	|	Wrap-up


### Post-workshop survey

We appreciate your feedback (both positive and negative !) - please fill out the short post-workshop survey [Feedback Survey](https://docs.google.com/forms/d/e/1FAIpQLSdmWreDIWjVsIR5g22jvcypH8ChFyMJ506HTAIoMIJYzjD-3Q/viewform) in the last 5 mins.

<!--chapter:end:02-overview.Rmd-->

```{r include=FALSE, cache=FALSE}
# example R options set globally
options(width = 60)

# example chunk options set globally
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE
)


# This reads the list of files/directories under
# copy_resources: in _bookdown.yml and copies them
# to the output document folder.
library(yaml)
library(fs)

yaml_path <- "_bookdown.yml"
config <- yaml::read_yaml(yaml_path)
additional_resources <- config$copy_resources
output_dir <- config$output_dir

copy_resources <- function(resources, output_dir) {
  for (resource in resources) {
    if (fs::file_exists(resource)) {
      if (fs::is_file(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(resource, target, overwrite = TRUE)
      }
      else if (fs::is_dir(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::dir_copy(resource, target, overwrite = TRUE)
      }
    } else if (grepl("[*?]", resource)) {
      files <- Sys.glob(resource)
      for (file in files) {
        target <- file.path(output_dir, file)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(file, target, overwrite = TRUE)
      }
    } else {
      warning(paste("Resource", resource, "not found or not recognized."))
    }
  }
}


copy_resources(additional_resources, output_dir)
```
# Enrichment Statistics



Enrichment statistics are based on a contingency table like so:

|        Gene        | ..in term | ..not in term | Total |
|:------------------:|----------:|--------------:|------:|
|     ..in gene list |        50 |           100 |   150 |
| ..not in gene list (but in background) |       200 |         15900 | 16100 |
|              Total |       250 |         16000 | 16250 |


This is based on the 16250 genes that were measured in your experiment. 

Note that there might be extra genes that weren't measured these are excluded from the calculations entirely. E.g. There might have been an extra 5000 terms (some of which might have been annotated with the term of interest), making for 21250 _annotated_ genes.



---

## Interactive Calculator

[*Link to open toy enrichment calculator*](https://bioinformatics3.erc.monash.edu/rsconnect/content/241/). 

This calculates enrichment for a single hypothetical genelist (e.g. your RNAseq differentially expressed genelist) against a single hypothetical 'term' (some set of interesting genes, e.g. synaptic signaling genes). It makes a Venn diagram and a wordy description of what is being tested.

You can adjust various factors and see their effect on the enrichment p-values. 


> _Note:_ This is just a toy calculator for this training, it quite limited. Bonus points if you break it. There are online hypergeometric test or fishers exact test calculators available if you ever need to calculate this directly e.g. : https://keisan.casio.com/exec/system/1180573201  


---

## Questions 

1. Is it significant at p=0.05?
<details>
<summary>Show</summary>
No, corrected pval=0.087
</details>

2. What about with a smaller background of 5000 genes (e.g. proteomic datasets)?
<details>
<summary>Show</summary>
Even less so - corrected pval=1
</details>

3. Or, testing against a smaller database of terms; 2000 terms instead of 10000? With the original 16000 gene background.
<details>
<summary>Show</summary>
Yes, now corrected pval=0.017
</details>

4. 19 out of 200 differentially expressed genes (9.5%), need to hit for a 500-gene term (3.1% of all genes) to be significant at (p=0.048). How many hits would be needed for a more specific 30-gene term?
<details>
<summary>Show</summary>
5 hits - 2.5% of the differentially expressed genes vs 0.19% of all genes
</details>

<!--chapter:end:03-stats.Rmd-->

```{r include=FALSE, cache=FALSE}
# example R options set globally
options(width = 60)

# example chunk options set globally
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE
)


# This reads the list of files/directories under
# copy_resources: in _bookdown.yml and copies them
# to the output document folder.
library(yaml)
library(fs)

yaml_path <- "_bookdown.yml"
config <- yaml::read_yaml(yaml_path)
additional_resources <- config$copy_resources
output_dir <- config$output_dir

copy_resources <- function(resources, output_dir) {
  for (resource in resources) {
    if (fs::file_exists(resource)) {
      if (fs::is_file(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(resource, target, overwrite = TRUE)
      }
      else if (fs::is_dir(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::dir_copy(resource, target, overwrite = TRUE)
      }
    } else if (grepl("[*?]", resource)) {
      files <- Sys.glob(resource)
      for (file in files) {
        target <- file.path(output_dir, file)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(file, target, overwrite = TRUE)
      }
    } else {
      warning(paste("Resource", resource, "not found or not recognized."))
    }
  }
}


copy_resources(additional_resources, output_dir)
```
# Example Analysis


## SH-SY5Y Differentiation

SH-SY5Y is a commonly used neuroblastoma cell line. 
With appropriate treatment, it can be induced to differentiate into a ‘more neuronal’ form. 
Differentiated cells look quite different, growing thin neurites out from the body of the cell.


![SH-SY5Y](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/shsy5ydiff.png)
<!-- seems to point to content dir not common root : ![shsy5](/img/shsy5ydiff.png)-->

_Image is derived from Figure 4 (Pezzini et al. 2017)_



## The question: What pathways are involved in SH-SY5Y Differentiation?

In their paper [_Transcriptomic Profiling Discloses Molecular and Cellular Events Related to Neuronal Differentiation in SH-SY5Y Neuroblastoma Cells_](https://link.springer.com/article/10.1007%2Fs10571-016-0403-y) Pezzini et al induced differentiation of the SH-SY5Y Neuroblastoma cell line and measured transcriptomic changes via RNAseq (Pezzini et al. 2017). 
They then looked at functional enrichment of differentially expressed genes.


## The data : Differentially expressed genes

The example dataset for today is the RNAseq differential expression results.  

They can be accessed via this link: 
http://degust.erc.monash.edu/degust/compare.html?code=5b2c7805ab8f8c5f2dc8c72e61b049b0#?plot=mds

This has been reanalysed from the published raw data, via the degust tool. 

> Note: Other tools and approaches will have different looking results - but generally you will end up with a table of genes with some measure of statistical confidence. 
The methods for functional enrichment analysis should be similar.

<!--chapter:end:04-example-dataset.Rmd-->

```{r include=FALSE, cache=FALSE}
# example R options set globally
options(width = 60)

# example chunk options set globally
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE
)


# This reads the list of files/directories under
# copy_resources: in _bookdown.yml and copies them
# to the output document folder.
library(yaml)
library(fs)

yaml_path <- "_bookdown.yml"
config <- yaml::read_yaml(yaml_path)
additional_resources <- config$copy_resources
output_dir <- config$output_dir

copy_resources <- function(resources, output_dir) {
  for (resource in resources) {
    if (fs::file_exists(resource)) {
      if (fs::is_file(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(resource, target, overwrite = TRUE)
      }
      else if (fs::is_dir(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::dir_copy(resource, target, overwrite = TRUE)
      }
    } else if (grepl("[*?]", resource)) {
      files <- Sys.glob(resource)
      for (file in files) {
        target <- file.path(output_dir, file)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(file, target, overwrite = TRUE)
      }
    } else {
      warning(paste("Resource", resource, "not found or not recognized."))
    }
  }
}


copy_resources(additional_resources, output_dir)
```
# Defining the genelist



Starting from those differential expression results [here](http://degust.erc.monash.edu/degust/compare.html?code=5b2c7805ab8f8c5f2dc8c72e61b049b0#?plot=mds), how do we go about getting a genelist to calculate enrichment on? 




## Activities

Todays exercise follows the process of getting the differentially expressed gene list using excel. You could use another spreadsheet program, or some may prefer a programming language like R .

1. Download the full table of data from either degust, or the csv file here:
[Pezzini2016_SHSY5Ycelldiff_DE_table.csv](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/data/Pezzini2016_SHSY5Ycelldiff_DE_table.csv). Import into excel. <!-- File>Import --> 

2. How many genes are differentially expressed? In these results the FDR Column contains the corrected p-value, and the 'differentiated' column shows the log2 fold-change of differentiated cells vs untreated cells (log2(diff)-log2(undiff)); 0 is unchanged, 1 is doubled, -1 is halved.

    - Significant at 0.01? 
    - That's a particularly large number of genes - perhaps not unexpected given how much the cells are changed this experiment. How many significant genes also have 2-fold change in expression?

    - For this workshop, get the genes with a FDR <1x10^-4 and 2x fold change. Note that this is a ridiculous threshold - most experiments yeild far less differential expression, but the difference between these two cell conditions is pretty extreme! Typically you would only filter at p<0.01 (and occasionally 2-fold change) - you might see 10s to 100s of results. However, this arbitrary threshold gives a more typical number of differentially expressed genes for downstream analysis. An alternative approach could be to take the top 500 genes.

    {{%expand Show%}} There are 4923 differentially expressed genes, 2149 of which have a 2-fold change in expression. With the aggressive filtering - there are 198 genes left {{%/expand%}}


3. How many genes are _tested_? This is your background.
{{%expand Show%}} 14420 genes tested. {{%/expand%}}

<!--But with ~20k human genes - why are there genes missing? **14420** --> 


---

## Common gotcha

Can you find SEPT4? Because [_Gene name errors are widespread in the scientific literature_](https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1044-7)

You can't revert the gene names automatically (try converting it to text!). You have to avoid it in the first place by importing gene columns as 'text' columns in excel.  See video from HUGO : https://www.genenames.org/help/faq/#!/#tocAnchor-1-25-1

<!--NB: You can ignore these for this workshop, but you want this to be right for publication!-->


---

## Example

An example excel document showing this filtering process is here: [Pezzini2016_SHSY5Ycelldiff_DE_table_filtering.xlsx](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/data/Pezzini2016_SHSY5Ycelldiff_DE_table_filtering.xlsx). 

<!--chapter:end:05-genelists.Rmd-->

```{r include=FALSE, cache=FALSE}
# example R options set globally
options(width = 60)

# example chunk options set globally
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE
)


# This reads the list of files/directories under
# copy_resources: in _bookdown.yml and copies them
# to the output document folder.
library(yaml)
library(fs)

yaml_path <- "_bookdown.yml"
config <- yaml::read_yaml(yaml_path)
additional_resources <- config$copy_resources
output_dir <- config$output_dir

copy_resources <- function(resources, output_dir) {
  for (resource in resources) {
    if (fs::file_exists(resource)) {
      if (fs::is_file(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(resource, target, overwrite = TRUE)
      }
      else if (fs::is_dir(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::dir_copy(resource, target, overwrite = TRUE)
      }
    } else if (grepl("[*?]", resource)) {
      files <- Sys.glob(resource)
      for (file in files) {
        target <- file.path(output_dir, file)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(file, target, overwrite = TRUE)
      }
    } else {
      warning(paste("Resource", resource, "not found or not recognized."))
    }
  }
}


copy_resources(additional_resources, output_dir)
```
# Reporting results


Once we have done an enrichment analysis - how to communicate the results? Like everything - it depends what you need to say. Some examples are below.

## In text

If you just need to emphasise that the differential expression relates to a condition of interest, you don't need much:

> Genes differentially expressed after SH-SY5Y cell differentiation were enriched for GO term "regulation of neurogenesis", adjusted pval < 0.01).

And in the methods:

> Enrichment calculated for differentially expressed genes with the g:GOSt enrichment tool [(Raudvere et al, 2019)](https://academic.oup.com/nar/article/47/W1/W191/5486750) using a background of tested genes.


## As a table

For a more complete view, a table of the significant or top _n_ terms can be useful. E.g In a supplementary figure 

The top 10 enriched GO terms for the differentially expressed genes;

| GO:BP Term                               | Term ID    | Adjusted p-value | Term Size | Num DE Genes      |
|------------------------------------------|------------|-----------------:|----------:|------------------:|
| system process                           | GO:0003008 | 2.90E-04         | 1243      | 45                |
| nervous system development               | GO:0007399 | 4.19E-04         | 1985      | 60                |
| regulation of cell development           | GO:0060284 | 1.98E-03         | 795       | 33                |
| central nervous system development       | GO:0007417 | 2.67E-03         | 805       | 33                |
| regulation of neurogenesis               | GO:0050767 | 5.59E-03         | 707       | 30                |
| regulation of nervous system development | GO:0051960 | 5.78E-03         | 790       | 32                |
| regulation of cell differentiation       | GO:0045595 | 6.03E-03         | 1471      | 47                |
| multicellular organismal process         | GO:0032501 | 2.04E-02         | 5300      | 111               |
| system development                       | GO:0048731 | 2.88E-02         | 3668      | 85                |
| neurogenesis                             | GO:0022008 | 4.36E-02         | 1375      | 43                |



## As a figure

Plots of -log p-value are a popular option for a figure. By taking the exponent of the p-value bigger bars indicate more significance.

For instance, this figure is taken from the [(Pezzini et al. 2017)](https://link.springer.com/article/10.1007%2Fs10571-016-0403-y) paper. 
Note that in this figure shows 2 specifics categories from the IPA (ingenuity) database using the IPA tool (not covered here), so the terms themselves differ. 

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/NegLogPvalPlot_Pezzini2017.png)

You can also build on such a plot with number of genes and the like. For an example, see the 'bubble' chart produced by a package called pathfindR here: https://www.biostars.org/p/322415/

----

There are also tools like cluego (a cytoscape plugin) that build enriched terms into a network : http://apps.cytoscape.org/apps/cluego

<!--chapter:end:06-reporting.Rmd-->

```{r include=FALSE, cache=FALSE}
# example R options set globally
options(width = 60)

# example chunk options set globally
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE
)


# This reads the list of files/directories under
# copy_resources: in _bookdown.yml and copies them
# to the output document folder.
library(yaml)
library(fs)

yaml_path <- "_bookdown.yml"
config <- yaml::read_yaml(yaml_path)
additional_resources <- config$copy_resources
output_dir <- config$output_dir

copy_resources <- function(resources, output_dir) {
  for (resource in resources) {
    if (fs::file_exists(resource)) {
      if (fs::is_file(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(resource, target, overwrite = TRUE)
      }
      else if (fs::is_dir(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::dir_copy(resource, target, overwrite = TRUE)
      }
    } else if (grepl("[*?]", resource)) {
      files <- Sys.glob(resource)
      for (file in files) {
        target <- file.path(output_dir, file)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(file, target, overwrite = TRUE)
      }
    } else {
      warning(paste("Resource", resource, "not found or not recognized."))
    }
  }
}


copy_resources(additional_resources, output_dir)
```
# Resources

---

Please find a link to today's presentation slides [here](../../enrichment_analysis_2024.pdf)


-----

The following tools might be useful for downstream functional analysis; this includes some not covered in todays workshop. 

<!-- https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/shsy5ydiff.png) 
http://localhost:1313/enrichment_analysis_workshop/img/david.png
--> 

Note that most of these tools do more than just enrichment tests, and some include their own databases. 

## g:Profiler / g:GOSt

https://biit.cs.ut.ee/gprofiler/gost

The g:GOSt 'functional profiling' tool of g:Profiler calculates 
It has a clean modern interface and a handy summary of which genes contribute to the enrichment. 

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/gprofiler.png)

## PANTHER 

http://www.pantherdb.org/

PANTHER performs overrepresentation tests across multiple databases; Gene ontology, reactome, PANTHER pathways and protein classes. Allows more control over the statistical test used and clearly summarises what was actually done.

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/panther.png)

## DAVID 

https://david.ncifcrf.gov/

Via its 'functional annotation' tool, DAVID allows you to calculate functional enrichment across a number of databases ; Gene Ontology, KEGG, reactome and others. Reliable, with a slightly clunky interface.

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/david.png)

## Enrichr

https://amp.pharm.mssm.edu/Enrichr/

Enrichr easily calculates enrichment across a wide range of databases. Currently does not allow for a background set. 

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/enrichr.png)



## Reactome

https://reactome.org/

The core of reactome is the reactome pathways and browser. ALthough other tools use the reactome database, the reactome website provides a means to browse enrichment within the pathway browser view.

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/reactome.png)



## Biocyc

https://biocyc.org/

Biocyc is another suite of tools for enrichment and pathway browsing, which is particularly useful for prokaryotic work. It is licensed, but Monash does have a license.

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/biocyc.png)



## STRINGdb

https://string-db.org/

STRING is not a functional enrichment tool, rather it is a convenient way to explore interactions within a genelist. Results are viewed as an interaction network. Best suited to smaller genelists.

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/string.png)


## Gene Ontology

http://geneontology.org/

Gene Ontology (GO) terms are the most widely use set of functional annotations, used by many enrichment tools. The gene ontology resource website itself provides several tools for browsing the GO term hierarchy.

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/go.png)

## KEGG

https://www.genome.jp/kegg/

A well known curated pathway database. It is used by many other tools but with a caveat - KEGG moved to a subscription model in 2011, and so enrichment tools need to use the last open release from 2011. However up to date KEGG pathways are browsable directly through their website. 

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/kegg.png)


## GSEA and MSigDB

http://software.broadinstitute.org/gsea/index.jsp

The desktop-based GSEA tool is (one of many) gene set enrichment approaches. It uses of gene rankings across all genes rather than hypogeometric or fishers-exact tests of genelist enrichment.  MSigDB (Molecular signatures database) is a suite of annotation databases suitable for GSEA analysis.

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/gsea.png)


## MetaboAnalyst
MetaboAnalyst is popular among the metabolomics community for statistical, functional and integrative analysis of metabolomics data. It has a feature called **Functional enrichment analysis**, which performs metabolite set enrichment analysis, metabolic pathway analysis, and pathway activity prediction from MS peaks.

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/metaboanalyst.png)

## Cytoscape

https://cytoscape.org/

Cytoscape is a desktop-based biological network analysis / visualization tool, rather than a functional enrichment tool (although plugins can change that). It is mentioned here because it is often useful as a next step when you need to create custom figures showing the interactions of an interesting biological pathway. 

![](https://monashbioinformaticsplatform.github.io/enrichment_analysis_workshop/img/cytoscape.png)

<!--chapter:end:07-resources.Rmd-->

```{r include=FALSE, cache=FALSE}
# example R options set globally
options(width = 60)

# example chunk options set globally
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE
)


# This reads the list of files/directories under
# copy_resources: in _bookdown.yml and copies them
# to the output document folder.
library(yaml)
library(fs)

yaml_path <- "_bookdown.yml"
config <- yaml::read_yaml(yaml_path)
additional_resources <- config$copy_resources
output_dir <- config$output_dir

copy_resources <- function(resources, output_dir) {
  for (resource in resources) {
    if (fs::file_exists(resource)) {
      if (fs::is_file(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(resource, target, overwrite = TRUE)
      }
      else if (fs::is_dir(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::dir_copy(resource, target, overwrite = TRUE)
      }
    } else if (grepl("[*?]", resource)) {
      files <- Sys.glob(resource)
      for (file in files) {
        target <- file.path(output_dir, file)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(file, target, overwrite = TRUE)
      }
    } else {
      warning(paste("Resource", resource, "not found or not recognized."))
    }
  }
}


copy_resources(additional_resources, output_dir)
```
# End of Session Challenge

## Dr Dodge's Experiment

There's quite a few ways you can calculate functional enrichment - so there's always a risk of [p-hacking](https://bitesizebio.com/31497/guilty-p-hacking/), whether accidental or deliberate. 

_So lets go deliberate..._

Dr Dodge is convinced that your experiment should turn out with relevance to GO term 'segmentation' - but p=0.06! But they _must_ be significant, the paper needs be submitted by Friday! 

What hacky and statistically questionable approaches could you apply to call these results "significant"?

<!--chapter:end:08-challenge.Rmd-->

```{r include=FALSE, cache=FALSE}
# example R options set globally
options(width = 60)

# example chunk options set globally
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE
)


# This reads the list of files/directories under
# copy_resources: in _bookdown.yml and copies them
# to the output document folder.
library(yaml)
library(fs)

yaml_path <- "_bookdown.yml"
config <- yaml::read_yaml(yaml_path)
additional_resources <- config$copy_resources
output_dir <- config$output_dir

copy_resources <- function(resources, output_dir) {
  for (resource in resources) {
    if (fs::file_exists(resource)) {
      if (fs::is_file(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(resource, target, overwrite = TRUE)
      }
      else if (fs::is_dir(resource)) {
        target <- file.path(output_dir, resource)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::dir_copy(resource, target, overwrite = TRUE)
      }
    } else if (grepl("[*?]", resource)) {
      files <- Sys.glob(resource)
      for (file in files) {
        target <- file.path(output_dir, file)
        fs::dir_create(fs::path_dir(target), recurse = TRUE)
        fs::file_copy(file, target, overwrite = TRUE)
      }
    } else {
      warning(paste("Resource", resource, "not found or not recognized."))
    }
  }
}


copy_resources(additional_resources, output_dir)
```
# Feedback


We appreciate your feedback (both positive and negative !) - please fill out the short post-workshop survey [Feedback Survey](https://docs.google.com/forms/d/e/1FAIpQLSdmWreDIWjVsIR5g22jvcypH8ChFyMJ506HTAIoMIJYzjD-3Q/viewform)

<!--chapter:end:09-end.Rmd-->

